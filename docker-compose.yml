services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      PORT: ${BACKEND_PORT}
      DB_PATH: /app/data/tasks.db
      JWT_SECRET: ${JWT_SECRET}
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      OPENAI_BASE_URL: ${OPENAI_BASE_URL}
      AI_MODEL: ${AI_MODEL}
      GEMINI_API_KEY: ${GEMINI_API_KEY}
      CORS_ORIGIN: ${CORS_ORIGIN}
    volumes:
      - v-ask-data:/app/data
    restart: unless-stopped
    read_only: true
    security_opt:
      - no-new-privileges:true

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    environment:
      NUXT_PUBLIC_API_BASE: ${NUXT_PUBLIC_API_BASE}
    depends_on:
      - backend
    restart: unless-stopped
    read_only: true
    security_opt:
      - no-new-privileges:true

volumes:
  v-ask-data:
